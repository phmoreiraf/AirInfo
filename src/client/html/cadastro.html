<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" href="../css/cadastro.css">

    <title>Cadastro</title>
</head>

<body>



    <div class="login-box">
        <h2>Cadastro</h2>

        <form onsubmit="checkSenha(event)">
            <div class="user-box">
                <input type="email" name="email" required="">
                <label>Email</label>
            </div>
            <div class="user-box">
                <input class="password" type="password" name="senha" required="">
                <label>Senha</label>
            </div>
            <div class="user-box">
                <input class="password" type="password" name="senha2" required="">
                <label>Confirme a senha</label>
            </div>
            <button class="btn__submit" type="submit">Cadastrar</button>
        </form>
        <script>
            async function checkSenha(e) {
                console.log('jorge')
                if (e.target.senha.value === e.target.senha2.value) {
                    criarUsuario(e)
                    window.location.href = 'login.html'
                } else {
                    alert('Senhas diferentes')
                }
            }

            async function criarUsuario(e) {
                e.preventDefault();
                try {
                    const response = await fetch('http://localhost:8000/usuarioPost', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            email: e.target.email.value,
                            senha: e.target.senha.value,
                            userType: false
                        })
                    });
                    const dados = await response.json();
                    console.log(dados);
                } catch (erro) {
                    console.log(erro);
                }
            }
        </script>
        <script src="https://code.jquery.com/jquery-3.6.3.js"></script>
        <script src="/src/client/js/masks.js"></script>
</body>

</html>